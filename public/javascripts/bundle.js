!function(e,n){"use strict";e.ajaxPrefilter(function(e,n,t){if(e.iframe)return e.originalURL=e.url,"iframe"}),e.ajaxTransport("iframe",function(n,t,a){function o(){d.each(function(n,t){var a=e(t);a.data("clone").replaceWith(a)}),i.remove(),l.one("load",function(){l.remove()}),l.attr("src","about:blank")}var i=null,l=null,s="iframe-"+e.now(),d=e(n.files).filter(":file:enabled"),c=null,u=null;if(n.dataTypes.shift(),n.data=t.data,d.length)return i=e("<form enctype='multipart/form-data' method='post'></form>").hide().attr({action:n.originalURL,target:s}),"string"==typeof n.data&&n.data.length>0&&e.error("data must not be serialized"),e.each(n.data||{},function(n,t){e.isPlainObject(t)&&(n=t.name,t=t.value),e("<input type='hidden' />").attr({name:n,value:t}).appendTo(i)}),e("<input type='hidden' value='IFrame' name='X-Requested-With' />").appendTo(i),u=n.dataTypes[0]&&n.accepts[n.dataTypes[0]]?n.accepts[n.dataTypes[0]]+("*"!==n.dataTypes[0]?", */*; q=0.01":""):n.accepts["*"],e("<input type='hidden' name='X-HTTP-Accept'>").attr("value",u).appendTo(i),c=d.after(function(n){var t=e(this),a=t.clone().prop("disabled",!0);return t.data("clone",a),a}).next(),d.appendTo(i),{send:function(n,t){l=e("<iframe src='about:blank' name='"+s+"' id='"+s+"' style='display:none'></iframe>"),l.one("load",function(){l.one("load",function(){var e=this.contentWindow?this.contentWindow.document:this.contentDocument?this.contentDocument:this.document,n=e.documentElement?e.documentElement:e.body,a=n.getElementsByTagName("textarea")[0],i=a&&a.getAttribute("data-type")||null,l=a&&a.getAttribute("data-status")||200,s=a&&a.getAttribute("data-statusText")||"OK",d={html:n.innerHTML,text:i?a.value:n?n.textContent||n.innerText:null};o(),t(l,s,d,i?"Content-Type: "+i:null)}),i[0].submit()}),e("body").append(i,l)},abort:function(){null!==l&&(l.unbind("load").attr("src","about:blank"),o())}}})}(jQuery);var index=function(){var e=function(e){var n=$("#loadingToast");e?n.fadeIn(100):n.fadeOut(100)},n=function(e){$(".index-page").hide(),$(".index-page").each(function(n,t){if($(this).data("myIndex")===e)return void $(this).show()})},t=function(e){$(".com-titleHeader-a").each(function(e,n){$(this).removeClass("com-titleHeader-a-checked")}),$(e).addClass("com-titleHeader-a-checked"),n($(e).data("myIndex"))},a=function(){$(".index-page").each(function(e,n){$(this).data("myIndex",e),0!==e&&$(this).hide()}),$(".com-titleHeader-a").each(function(e,n){0===e&&$(this).addClass("com-titleHeader-a-checked"),$(this).data("myIndex",e)}),$(".com-titleHeader-a").on("click",function(){return!$(this).is(".com-titleHeader-a-checked")&&(t(this),!1)})};return{init:a,showProgress:e}}(),index_js_page=function(){var e="/upload",n="/minifyjs",t="/download",a=[],o='<p class="index-file-item">                  <span class="index-file-item-filename"></span>                  <span class="index-file-item-status-loading"></span><a class="index-file-item-delete btn btn-red" style="display: none">删除</a> </p>',i=function(){$.ajax(e,{files:$("#upload_js"),iframe:!0,dataType:"json"}).done(function(e,n,t){console.log("done():",e.ok+","+e.filename),e.ok?(a.push(e.filename),f(!0),console.log("set yes use"),u()):($("#upload_js").val(""),f(!0),0===a.length&&$("#js-upload-complete").hide(),$("#jsPage .index-file-item-status-loading").parent().remove(),alert("上传失败,文件不能大于1mb"))}).fail(function(e,n,t){console.log("fail():"+e.status+","+n),alert("上传失败,或许网络原因，或许文件大于1mb")}).always(function(){console.log("always():")})},l=function(e){if(e)return e.indexOf(".js")!==-1&&(console.log("后缀:"+e.substring(e.length-3)),".js"===e.substring(e.length-3))},s=function(){$("#upload_js").on("change",function(){var e=$(this).val();return l(e)?void(e?(i(),c(d(e)),console.log("--newFileLine()"),f(!1),console.log("set no use")):console.info(!1)):($(this).val(""),alert("需要选择js后缀名的文件"))}),$("#js-upload-complete").on("click",function(){if($(this).data("canUpload")){if($(this).data("isLoading"))return;p(!0),m()}else alert("必须全部上传完毕才能点击")})},d=function(e){var n=e.split("\\"),t=n[n.length-1];return n=t.split("/"),t=n[n.length-1]},c=function(e){var n=$(o);n.data("filename",e);var t=n.find(".index-file-item-filename"),a=n.find(".index-file-item-status-loading"),i=n.find(".index-file-item-delete");i.on("click",function(){var e=$("#jsPage .index-file-item").index(n);console.log("您删除了第"+e+"个元素"),n.remove(),r(e)}),t.text(e),a.text("正在上传"),n.insertBefore($("#js-upload-complete").parent()),console.log("insert:"+e)},u=function(){$(".index-file-item-status-loading",$("#jsPage")).removeClass("index-file-item-status-loading").addClass("index-file-item-status-end").text("上传完毕"),$(".index-file-item-delete",$("#jsPage")).show()},f=function(e){var n=$("#js-upload-complete");n.show(),e?n.data("canUpload",!0):n.data("canUpload",!1)},r=function(e){a.splice(e,1),$("#upload_js").val(""),0===a.length&&$("#js-upload-complete").hide()},p=function(e){e?(index.showProgress(!0),$("#js-upload-complete").data("isLoading",!0)):(index.showProgress(!1),$("#js-upload-complete").data("isLoading",!1))},m=function(){console.log(JSON.stringify(a)),$.ajax(n,{data:{files:a},type:"POST",traditional:!0,dataType:"json"}).done(function(e,n,a){console.log("done():",e.ok),e.ok?(console.log("压缩的响应:ok"),window.location.href=t+"?type=js&filename="+e.filename,console.log("window open")):(console.log("压缩的响应:false"),alert("出错了"))}).fail(function(e,n,t){console.log("fail():"+e.status+","+n),alert("出错了")}).always(function(){console.log("always():"),p(!1)})};return{init:s}}(),index_css_page=function(){var e="/upload",n="/minifycss",t="/download",a=[],o='<p class="index-file-item">                  <span class="index-file-item-filename"></span>                  <span class="index-file-item-status-loading"></span><a class="index-file-item-delete btn btn-red" style="display: none">删除</a> </p>',i=function(){$.ajax(e,{files:$("#upload_css"),iframe:!0,dataType:"json"}).done(function(e,n,t){console.log("done():",e.ok+","+e.filename),e.ok?(a.push(e.filename),f(!0),console.log("set yes use"),u()):($("#cssPage .index-file-item-status-loading").parent().remove(),$("#upload_css").val(""),f(!0),0===a.length&&$("#css-upload-complete").hide(),alert("上传失败，文件不能大于1mb"))}).fail(function(e,n,t){console.log("fail():"+e.status+","+n),alert("上传失败,或许网络原因，或许文件大于1mb")}).always(function(){console.log("always():")})},l=function(e){if(e)return e.indexOf(".css")!==-1&&(console.log("后缀:"+e.substring(e.length-4)),".css"===e.substring(e.length-4))},s=function(){$("#upload_css").on("change",function(){var e=$(this).val();return l(e)?void(e?(i(),c(d(e)),console.log("--newFileLine()"),f(!1),console.log("set no use")):console.info(!1)):($(this).val(""),alert("需要选择css后缀名的文件"))}),$("#css-upload-complete").on("click",function(){if($(this).data("canUpload")){if($(this).data("isLoading"))return;r(!0),m()}else alert("必须全部上传完毕才能点击")})},d=function(e){var n=e.split("\\"),t=n[n.length-1];return n=t.split("/"),t=n[n.length-1]},c=function(e){var n=$(o);n.data("filename",e);var t=n.find(".index-file-item-filename"),a=n.find(".index-file-item-status-loading"),i=n.find(".index-file-item-delete");i.on("click",function(){var e=$("#cssPage .index-file-item").index(n);console.log("您删除了第"+e+"个元素"),n.remove(),p(e)}),t.text(e),a.text("正在上传"),n.insertBefore($("#css-upload-complete").parent()),console.log("insert:"+e)},u=function(){$(".index-file-item-status-loading",$("#cssPage")).removeClass("index-file-item-status-loading").addClass("index-file-item-status-end").text("上传完毕"),$(".index-file-item-delete",$("#cssPage")).show()},f=function(e){var n=$("#css-upload-complete");n.show(),e?n.data("canUpload",!0):n.data("canUpload",!1)},r=function(e){e?(index.showProgress(!0),$("#css-upload-complete").data("isLoading",!0)):(index.showProgress(!1),$("#css-upload-complete").data("isLoading",!1))},p=function(e){a.splice(e,1),$("#upload_css").val(""),0===a.length&&$("#css-upload-complete").hide()},m=function(){console.log(JSON.stringify(a)),$.ajax(n,{data:{files:a},type:"POST",traditional:!0,dataType:"json"}).done(function(e,n,a){console.log("done():",e.ok),e.ok?(console.log("压缩的响应:ok"),window.location.href=t+"?type=css&filename="+e.filename,console.log("window open")):(console.log("压缩的响应:false"),alert("出错了"))}).fail(function(e,n,t){console.log("fail():"+e.status+","+n),alert("出错了")}).always(function(){console.log("always():"),r(!1)})};return{init:s}}();